{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/market-edge/CinemaMarketShareChart.tsx"],"sourcesContent":["import React from 'react';\nimport { PieChart, Pie, Cell, ResponsiveContainer, Tooltip, Legend } from 'recharts';\nimport { Competitor } from '@/types/market-edge';\n\ninterface CinemaMarketShareChartProps {\n  competitors: Competitor[];\n  className?: string;\n}\n\nexport const CinemaMarketShareChart: React.FC<CinemaMarketShareChartProps> = ({\n  competitors,\n  className = ''\n}) => {\n  // Cinema-specific colors for UK market leaders\n  const CINEMA_COLORS = {\n    'Cineworld Group': '#E31E24', // Cineworld red\n    'Vue Entertainment': '#00A8E1', // Vue blue\n    'Odeon Cinemas': '#FFD700', // Odeon gold\n    'Empire Cinemas': '#8B0000', // Empire dark red\n    'Showcase Cinemas': '#FF4500', // Orange red\n    'Independent Cinemas': '#708090', // Slate gray for others\n  };\n\n  const chartData = React.useMemo(() => {\n    const competitorData = competitors\n      .filter(comp => comp.market_share_estimate && comp.market_share_estimate > 0)\n      .map(comp => ({\n        name: comp.name,\n        value: (comp.market_share_estimate || 0) * 100, // Convert to percentage\n        sites: comp.locations?.total_sites || 0,\n        screens: comp.locations?.total_screens || 0,\n        color: CINEMA_COLORS[comp.name as keyof typeof CINEMA_COLORS] || CINEMA_COLORS['Independent Cinemas']\n      }))\n      .sort((a, b) => b.value - a.value); // Sort by market share descending\n\n    // Calculate \"Others\" segment\n    const totalMarketShare = competitorData.reduce((sum, comp) => sum + comp.value, 0);\n    const odeonMarketShare = 20.5; // Odeon's approximate market share\n    const othersShare = Math.max(0, 100 - totalMarketShare - odeonMarketShare);\n\n    // Add Odeon (the client) as a reference point\n    const dataWithOdeon = [\n      {\n        name: 'Odeon Cinemas',\n        value: odeonMarketShare,\n        sites: 120,\n        screens: 950,\n        color: CINEMA_COLORS['Odeon Cinemas']\n      },\n      ...competitorData\n    ];\n\n    // Add others if significant\n    if (othersShare > 1) {\n      dataWithOdeon.push({\n        name: 'Independent & Others',\n        value: othersShare,\n        sites: 0,\n        screens: 0,\n        color: CINEMA_COLORS['Independent Cinemas']\n      });\n    }\n\n    return dataWithOdeon;\n  }, [competitors]);\n\n  const CustomTooltip = ({ active, payload, label }: any) => {\n    if (active && payload && payload.length) {\n      const data = payload[0].payload;\n      return (\n        <div className=\"bg-white p-3 border border-gray-200 rounded-lg shadow-lg\">\n          <p className=\"font-medium text-gray-900 mb-2\">{data.name}</p>\n          <p className=\"text-sm text-gray-600\">Market Share: {data.value.toFixed(1)}%</p>\n          {data.sites > 0 && (\n            <>\n              <p className=\"text-sm text-gray-600\">Cinema Sites: {data.sites}</p>\n              <p className=\"text-sm text-gray-600\">Total Screens: {data.screens}</p>\n            </>\n          )}\n        </div>\n      );\n    }\n    return null;\n  };\n\n  if (!chartData || chartData.length === 0) {\n    return (\n      <div className={`bg-white rounded-lg border border-gray-200 p-6 ${className}`}>\n        <h3 className=\"text-lg font-medium text-gray-900 mb-4\">UK Cinema Market Share</h3>\n        <div className=\"flex items-center justify-center h-64 text-gray-500\">\n          <div className=\"text-center\">\n            <div className=\"text-sm\">No market share data available</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`bg-white rounded-lg border border-gray-200 p-6 ${className}`}>\n      <div className=\"flex items-center justify-between mb-6\">\n        <h3 className=\"text-lg font-medium text-gray-900\">UK Cinema Market Share</h3>\n        <div className=\"text-sm text-gray-500\">\n          2024 Market Analysis\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Pie Chart */}\n        <div className=\"h-80\">\n          <ResponsiveContainer width=\"100%\" height=\"100%\">\n            <PieChart>\n              <Pie\n                data={chartData}\n                cx=\"50%\"\n                cy=\"50%\"\n                labelLine={false}\n                label={({ name, value }) => `${name}: ${value.toFixed(1)}%`}\n                outerRadius={100}\n                fill=\"#8884d8\"\n                dataKey=\"value\"\n              >\n                {chartData.map((entry, index) => (\n                  <Cell key={`cell-${index}`} fill={entry.color} />\n                ))}\n              </Pie>\n              <Tooltip content={<CustomTooltip />} />\n            </PieChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Market Share Details */}\n        <div className=\"space-y-4\">\n          <h4 className=\"text-base font-semibold text-gray-900\">Market Position Analysis</h4>\n          {chartData.map((competitor, index) => (\n            <div key={competitor.name} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n              <div className=\"flex items-center\">\n                <div \n                  className=\"w-4 h-4 rounded-full mr-3\"\n                  style={{ backgroundColor: competitor.color }}\n                />\n                <div>\n                  <p className=\"text-sm font-medium text-gray-900\">{competitor.name}</p>\n                  <p className=\"text-xs text-gray-500\">\n                    Rank #{index + 1} • {competitor.value.toFixed(1)}% market share\n                  </p>\n                </div>\n              </div>\n              <div className=\"text-right\">\n                {competitor.sites > 0 && (\n                  <>\n                    <p className=\"text-sm font-medium text-gray-900\">{competitor.sites} sites</p>\n                    <p className=\"text-xs text-gray-500\">{competitor.screens} screens</p>\n                  </>\n                )}\n              </div>\n            </div>\n          ))}\n          \n          {/* Market insights */}\n          <div className=\"mt-6 p-4 bg-blue-50 rounded-lg\">\n            <h5 className=\"text-sm font-semibold text-blue-900 mb-2\">Key Market Insights</h5>\n            <ul className=\"text-xs text-blue-700 space-y-1\">\n              <li>• Cineworld leads with largest screen count and geographic coverage</li>\n              <li>• Vue focuses on premium locations and IMAX experiences</li>\n              <li>• Odeon maintains strong position with prime London locations</li>\n              <li>• Market consolidation continues with top 4 chains controlling 75%+ share</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};"],"names":["CinemaMarketShareChart","competitors","className","CINEMA_COLORS","chartData","React","useMemo","competitorData","filter","comp","market_share_estimate","map","name","value","sites","locations","total_sites","screens","total_screens","color","sort","a","b","totalMarketShare","reduce","sum","odeonMarketShare","othersShare","Math","max","dataWithOdeon","push","CustomTooltip","active","payload","label","length","data","div","p","toFixed","h3","ResponsiveContainer","width","height","PieChart","Pie","cx","cy","labelLine","outerRadius","fill","dataKey","entry","index","Cell","Tooltip","content","h4","competitor","style","backgroundColor","h5","ul","li"],"mappings":"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"}