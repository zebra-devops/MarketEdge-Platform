{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/ui/AccountMenu.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport {\n  UserCircleIcon,\n  Cog6ToothIcon,\n  ShieldCheckIcon,\n  ArrowRightOnRectangleIcon,\n  ChevronDownIcon\n} from '@heroicons/react/24/outline';\nimport { useAuthContext } from '@/hooks/useAuth';\nimport { User } from '@/types/auth';\n\ninterface AccountMenuProps {\n  className?: string;\n}\n\nexport const AccountMenu: React.FC<AccountMenuProps> = ({ className = '' }) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const { user, logout } = useAuthContext();\n  const menuRef = useRef<HTMLDivElement>(null);\n  const router = useRouter();\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    // Only add event listeners on client side\n    if (typeof window !== 'undefined') {\n      document.addEventListener('mousedown', handleClickOutside);\n      return () => document.removeEventListener('mousedown', handleClickOutside);\n    }\n  }, []);\n\n  const handleLogout = () => {\n    logout();\n    setIsOpen(false);\n  };\n\n  // Check if user has admin role\n  const isAdmin = user?.role === 'admin';\n\n  if (!user) {\n    return null;\n  }\n\n  return (\n    <div className={`relative ${className}`} ref={menuRef}>\n      {/* Account Button */}\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n      >\n        <UserCircleIcon className=\"h-6 w-6\" />\n        <span className=\"hidden sm:block\">{user.email}</span>\n        <ChevronDownIcon className={`h-4 w-4 transition-transform ${isOpen ? 'rotate-180' : ''}`} />\n      </button>\n\n      {/* Dropdown Menu */}\n      {isOpen && (\n        <div className=\"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50\">\n          <div className=\"py-1\">\n            {/* User Info Header */}\n            <div className=\"px-4 py-3 border-b border-gray-100\">\n              <p className=\"text-sm font-medium text-gray-900\">{user.email}</p>\n              <p className=\"text-xs text-gray-500 capitalize\">{user.role} â€¢ {user.organisation_id || 'No Organisation'}</p>\n            </div>\n\n            {/* Settings */}\n            <button\n              onClick={() => {\n                // Navigate to settings page\n                router.push('/settings');\n                setIsOpen(false);\n              }}\n              className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\"\n            >\n              <Cog6ToothIcon className=\"h-4 w-4 mr-3\" />\n              Settings\n            </button>\n\n            {/* Admin Panel (only show if user is admin) */}\n            {isAdmin && (\n              <button\n                onClick={() => {\n                  // Navigate to admin page\n                  router.push('/admin');\n                  setIsOpen(false);\n                }}\n                className=\"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900\"\n              >\n                <ShieldCheckIcon className=\"h-4 w-4 mr-3\" />\n                Admin Panel\n              </button>\n            )}\n\n            {/* Divider */}\n            <div className=\"border-t border-gray-100 my-1\"></div>\n\n            {/* Logout */}\n            <button\n              onClick={handleLogout}\n              className=\"flex items-center w-full px-4 py-2 text-sm text-red-700 hover:bg-red-50 hover:text-red-900\"\n            >\n              <ArrowRightOnRectangleIcon className=\"h-4 w-4 mr-3\" />\n              Sign Out\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};"],"names":["AccountMenu","className","isOpen","setIsOpen","useState","user","logout","useAuthContext","menuRef","useRef","router","useRouter","useEffect","handleClickOutside","event","current","contains","target","window","document","addEventListener","removeEventListener","handleLogout","isAdmin","role","div","ref","button","onClick","UserCircleIcon","span","email","ChevronDownIcon","p","organisation_id","push","Cog6ToothIcon","ShieldCheckIcon","ArrowRightOnRectangleIcon"],"mappings":";;;;+BAgBaA;;;eAAAA;;;;+DAhBsC;4BACzB;yBAOnB;yBACwB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOxB,MAAMA,cAA0C,CAAC,EAAEC,YAAY,EAAE,EAAE;IACxE,MAAM,CAACC,QAAQC,UAAU,GAAGC,IAAAA,eAAQ,EAAC;IACrC,MAAM,EAAEC,IAAI,EAAEC,MAAM,EAAE,GAAGC,IAAAA,uBAAc;IACvC,MAAMC,UAAUC,IAAAA,aAAM,EAAiB;IACvC,MAAMC,SAASC,IAAAA,qBAAS;IAExB,mCAAmC;IACnCC,IAAAA,gBAAS,EAAC;QACR,MAAMC,qBAAqB,CAACC;YAC1B,IAAIN,QAAQO,OAAO,IAAI,CAACP,QAAQO,OAAO,CAACC,QAAQ,CAACF,MAAMG,MAAM,GAAW;gBACtEd,UAAU;YACZ;QACF;QAEA,0CAA0C;QAC1C,IAAI,OAAOe,WAAW,aAAa;YACjCC,SAASC,gBAAgB,CAAC,aAAaP;YACvC,OAAO,IAAMM,SAASE,mBAAmB,CAAC,aAAaR;QACzD;IACF,GAAG,EAAE;IAEL,MAAMS,eAAe;QACnBhB;QACAH,UAAU;IACZ;IAEA,+BAA+B;IAC/B,MAAMoB,UAAUlB,MAAMmB,SAAS;IAE/B,IAAI,CAACnB,MAAM;QACT,OAAO;IACT;IAEA,qBACE,sBAACoB;QAAIxB,WAAW,CAAC,SAAS,EAAEA,UAAU,CAAC;QAAEyB,KAAKlB;;0BAE5C,sBAACmB;gBACCC,SAAS,IAAMzB,UAAU,CAACD;gBAC1BD,WAAU;;kCAEV,qBAAC4B,uBAAc;wBAAC5B,WAAU;;kCAC1B,qBAAC6B;wBAAK7B,WAAU;kCAAmBI,KAAK0B,KAAK;;kCAC7C,qBAACC,wBAAe;wBAAC/B,WAAW,CAAC,6BAA6B,EAAEC,SAAS,eAAe,GAAG,CAAC;;;;YAIzFA,wBACC,qBAACuB;gBAAIxB,WAAU;0BACb,cAAA,sBAACwB;oBAAIxB,WAAU;;sCAEb,sBAACwB;4BAAIxB,WAAU;;8CACb,qBAACgC;oCAAEhC,WAAU;8CAAqCI,KAAK0B,KAAK;;8CAC5D,sBAACE;oCAAEhC,WAAU;;wCAAoCI,KAAKmB,IAAI;wCAAC;wCAAInB,KAAK6B,eAAe,IAAI;;;;;sCAIzF,sBAACP;4BACCC,SAAS;gCACP,4BAA4B;gCAC5BlB,OAAOyB,IAAI,CAAC;gCACZhC,UAAU;4BACZ;4BACAF,WAAU;;8CAEV,qBAACmC,sBAAa;oCAACnC,WAAU;;gCAAiB;;;wBAK3CsB,yBACC,sBAACI;4BACCC,SAAS;gCACP,yBAAyB;gCACzBlB,OAAOyB,IAAI,CAAC;gCACZhC,UAAU;4BACZ;4BACAF,WAAU;;8CAEV,qBAACoC,wBAAe;oCAACpC,WAAU;;gCAAiB;;;sCAMhD,qBAACwB;4BAAIxB,WAAU;;sCAGf,sBAAC0B;4BACCC,SAASN;4BACTrB,WAAU;;8CAEV,qBAACqC,kCAAyB;oCAACrC,WAAU;;gCAAiB;;;;;;;;AAQpE"}