{"version":3,"sources":["/Users/matt/Sites/MarketEdge/platform-wrapper/frontend/src/components/ui/FeatureFlaggedContent.tsx"],"sourcesContent":["'use client'\n\nimport React from 'react'\nimport { useFeatureFlag } from '@/hooks/useFeatureFlags'\nimport LoadingSpinner from './LoadingSpinner'\nimport PlaceholderContent from './PlaceholderContent'\n\ninterface FeatureFlaggedContentProps {\n  flagKey: string\n  children: React.ReactNode\n  fallback?: React.ReactNode\n  loadingComponent?: React.ReactNode\n  errorComponent?: React.ReactNode\n  fallbackValue?: boolean\n  className?: string\n  enabledComponent?: React.ReactNode\n  disabledComponent?: React.ReactNode\n  // Placeholder options when flag is disabled\n  placeholderTitle?: string\n  placeholderDescription?: string\n  placeholderType?: 'info' | 'warning' | 'demo' | 'data'\n  placeholderIcon?: React.ComponentType<{ className?: string }>\n}\n\nexport default function FeatureFlaggedContent({\n  flagKey,\n  children,\n  fallback,\n  loadingComponent,\n  errorComponent,\n  fallbackValue = false,\n  className = '',\n  enabledComponent,\n  disabledComponent,\n  placeholderTitle,\n  placeholderDescription,\n  placeholderType = 'info',\n  placeholderIcon\n}: FeatureFlaggedContentProps) {\n  const { isEnabled, isLoading, error, config } = useFeatureFlag(flagKey, {\n    fallbackValue\n  })\n\n  // Loading state\n  if (isLoading) {\n    if (loadingComponent) {\n      return <div className={className}>{loadingComponent}</div>\n    }\n    return (\n      <div className={`flex items-center justify-center p-8 ${className}`}>\n        <LoadingSpinner size=\"lg\" />\n      </div>\n    )\n  }\n\n  // Error state\n  if (error && !isEnabled) {\n    if (errorComponent) {\n      return <div className={className}>{errorComponent}</div>\n    }\n    return (\n      <div className={className}>\n        <PlaceholderContent\n          title=\"Feature Unavailable\"\n          description=\"This feature is currently unavailable. Please try again later.\"\n          type=\"warning\"\n        />\n      </div>\n    )\n  }\n\n  const wrapperProps = {\n    className,\n    'data-feature-flag': flagKey,\n    'data-feature-enabled': isEnabled\n  }\n\n  // Feature is enabled\n  if (isEnabled) {\n    if (enabledComponent) {\n      return <div {...wrapperProps}>{enabledComponent}</div>\n    }\n    return <div {...wrapperProps}>{children}</div>\n  }\n\n  // Feature is disabled\n  if (disabledComponent) {\n    return <div {...wrapperProps}>{disabledComponent}</div>\n  }\n\n  if (fallback) {\n    return <div {...wrapperProps}>{fallback}</div>\n  }\n\n  // Default placeholder when disabled\n  if (placeholderTitle && placeholderDescription) {\n    return (\n      <div {...wrapperProps}>\n        <PlaceholderContent\n          title={placeholderTitle}\n          description={placeholderDescription}\n          type={placeholderType}\n          icon={placeholderIcon}\n        />\n      </div>\n    )\n  }\n\n  // No fallback specified, render nothing\n  return null\n}\n\n// Higher-order component version\nexport function withFeatureFlag<P extends object>(\n  Component: React.ComponentType<P>,\n  flagKey: string,\n  options: {\n    fallbackValue?: boolean\n    fallback?: React.ComponentType<P>\n    loadingComponent?: React.ComponentType\n    errorComponent?: React.ComponentType\n  } = {}\n) {\n  const WrappedComponent = (props: P) => {\n    const { isEnabled, isLoading, error } = useFeatureFlag(flagKey, {\n      fallbackValue: options.fallbackValue ?? false\n    })\n\n    if (isLoading && options.loadingComponent) {\n      const LoadingComponent = options.loadingComponent\n      return <LoadingComponent />\n    }\n\n    if (isLoading) {\n      return <LoadingSpinner size=\"lg\" />\n    }\n\n    if (error && options.errorComponent) {\n      const ErrorComponent = options.errorComponent\n      return <ErrorComponent />\n    }\n\n    if (!isEnabled && options.fallback) {\n      const FallbackComponent = options.fallback\n      return <FallbackComponent {...props} />\n    }\n\n    if (!isEnabled) {\n      return null\n    }\n\n    return <Component {...props} />\n  }\n\n  WrappedComponent.displayName = `withFeatureFlag(${Component.displayName || Component.name})`\n  \n  return WrappedComponent\n}\n\n// Hook for conditional rendering based on multiple flags\nexport function useFeatureFlaggedRender() {\n  return {\n    renderIfEnabled: (flagKey: string, component: React.ReactNode, fallback?: React.ReactNode) => {\n      const { isEnabled } = useFeatureFlag(flagKey)\n      return isEnabled ? component : (fallback || null)\n    },\n    \n    renderIfAllEnabled: (flagKeys: string[], component: React.ReactNode, fallback?: React.ReactNode) => {\n      // This would require a custom hook to check multiple flags\n      // For now, we'll use the first flag as an example\n      const { isEnabled } = useFeatureFlag(flagKeys[0])\n      return isEnabled ? component : (fallback || null)\n    },\n    \n    renderIfAnyEnabled: (flagKeys: string[], component: React.ReactNode, fallback?: React.ReactNode) => {\n      // This would require a custom hook to check multiple flags\n      // For now, we'll use the first flag as an example\n      const { isEnabled } = useFeatureFlag(flagKeys[0])\n      return isEnabled ? component : (fallback || null)\n    }\n  }\n}"],"names":["FeatureFlaggedContent","useFeatureFlaggedRender","withFeatureFlag","flagKey","children","fallback","loadingComponent","errorComponent","fallbackValue","className","enabledComponent","disabledComponent","placeholderTitle","placeholderDescription","placeholderType","placeholderIcon","isEnabled","isLoading","error","config","useFeatureFlag","div","LoadingSpinner","size","PlaceholderContent","title","description","type","wrapperProps","icon","Component","options","WrappedComponent","props","LoadingComponent","ErrorComponent","FallbackComponent","displayName","name","renderIfEnabled","component","renderIfAllEnabled","flagKeys","renderIfAnyEnabled"],"mappings":"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"}